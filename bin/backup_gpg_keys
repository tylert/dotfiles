#!/usr/bin/env bash

keyid="${1}"

# Yank down the latest
gpg --recv-key ${keyid} --keyserver pgp.mit.edi

# Export the public key
gpg --export --armor --no-emit-version --no-comment \
    ${keyid} > ${keyid}.gpg.pub.txt

# Export the private key
umask 0077
gpg --export-secret-key --armor --no-emit-version --no-comment \
    ${keyid} > ${keyid}.gpg.sec.txt

# Usually there is no secret key if this is someone else's key
if [ $(stat -c %s ${keyid}.gpg.sec.txt) -eq 0 ]; then
    rm ${keyid}.gpg.sec.txt
fi
